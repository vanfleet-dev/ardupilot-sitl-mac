services:
  sitl:
    image: orthuk/ardupilot-sitl-debian:latest
    container_name: ardupilot-sitl
    ports:
      # UDP port for single vehicle mode
      - "14550:14550/udp"
      # TCP ports for swarm mode (5760-5790 covers up to 30 vehicles)
      - "5760-5790:5760-5790/tcp"
    volumes:
      - ./logs:/ardupilot/logs
      - ./eeprom.bin:/ardupilot/eeprom.bin
      - ./docker-entrypoint.sh:/docker-entrypoint.sh:ro
    environment:
      - SITL_VEHICLE=${SITL_VEHICLE:-ArduPlane}
      - SITL_FRAME=${SITL_FRAME:-plane}
      - SWARM_MODE=${SWARM_MODE:-false}
      - SWARM_COUNT=${SWARM_COUNT:-}
      - OFFSET_LINE=${OFFSET_LINE:-90,10}
      - SITL_LOCATION=${SITL_LOCATION:-CMAC}
    entrypoint: ["/bin/bash", "/docker-entrypoint.sh"]
    restart: "no"
    stdin_open: true
    tty: true
